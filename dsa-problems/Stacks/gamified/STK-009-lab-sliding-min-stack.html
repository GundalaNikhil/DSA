<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STK-009: Window Watcher</title>
    <link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #222;
            --data: #fff;
            --window: rgba(255, 255, 255, 0.2);
            --hl: #fab1a0;
            --min: #00cec9;
        }

        body {
            font-family: 'Major Mono Display', monospace;
            background: var(--bg);
            color: var(--data);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none;
        }

        h1 { margin-top: 2rem; }

        .stream-container {
            position: relative;
            margin-top: 4rem;
            width: 800px;
            height: 150px;
            border: 2px solid #555;
            display: flex;
            align-items: center;
            overflow: hidden;
            background: #111;
        }

        .stream-track {
            display: flex;
            position: absolute;
            left: 0;
            transition: left 0.3s;
        }

        .data-item {
            width: 80px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border-right: 1px dashed #333;
            cursor: pointer;
        }
        
        .data-item:hover { background: #333; }
        .data-item.is-min { color: var(--min); font-weight: bold; }

        .window-frame {
            position: absolute;
            left: 0; /* Fixed visual pos? No, stream moves. */
            width: 240px; /* 3 items * 80 */
            height: 100%;
            border: 4px solid var(--hl);
            box-shadow: 0 0 20px rgba(250, 177, 160, 0.3);
            pointer-events: none;
            z-index: 10;
        }

        .controls { text-align: center; margin-top: 2rem; }
        .msg { font-size: 1.2rem; color: #fab1a0; min-height: 1.5em; }
        
        .btn {
            background: var(--hl);
            border: none;
            padding: 10px 20px;
            font-family: inherit;
            cursor: pointer;
            margin-top: 20px;
        }

    </style>
</head>
<body>

<h1>WINDOW WATCHER</h1>

<div class="stream-container">
    <div class="window-frame"></div> <!-- Fixed window visual at left -->
    <div class="stream-track" id="track">
        <!-- Items -->
    </div>
</div>

<div class="controls">
    <div class="msg" id="msg">Click the MINIMUM value inside the frame!</div>
    <div style="margin-top:10px">Score: <span id="score">0</span></div>
    <button class="btn" onclick="check()">Confirm & Slide</button>
</div>

<script>
    const K = 3;
    let data = [];
    let pos = 0;
    const ITEM_W = 80;
    
    function init() {
        data = Array(20).fill(0).map(() => Math.floor(Math.random() * 99));
        pos = 0;
        render();
    }

    function render() {
        const t = document.getElementById('track');
        t.innerHTML = '';
        data.forEach((v, i) => {
            const el = document.createElement('div');
            el.className = 'data-item';
            el.textContent = v;
            el.onclick = () => select(i);
            el.id = `item-${i}`;
            t.appendChild(el);
        });
        
        // Initial offset
        updateOffset();
    }

    function updateOffset() {
        // We actually want the stream to slide Left, so the fixed window "Right moves" over data.
        // Window is fixed at left (0 to 240px).
        // Item i should be at i*80.
        // pos is the index of first item in window.
        // So we shift track to -pos * 80.
        document.getElementById('track').style.left = `-${pos * ITEM_W}px`;
    }

    let selectedIdx = -1;

    function select(i) {
        // Must be in window [pos, pos+K-1]
        if (i < pos || i >= pos + K) {
            msg("That item is outside the window!");
            return;
        }
        
        // Visual
        document.querySelectorAll('.data-item').forEach(e => e.classList.remove('is-min'));
        document.getElementById(`item-${i}`).classList.add('is-min');
        selectedIdx = i;
    }

    function check() {
        if (selectedIdx === -1) {
            msg("Select a minimum first!");
            return;
        }

        // Verify min
        let windowVals = data.slice(pos, pos + K);
        let minVal = Math.min(...windowVals);
        let userVal = data[selectedIdx];
        
        if (userVal === minVal) {
            msg("Correct!");
            pos++;
            document.getElementById('score').textContent = parseInt(document.getElementById('score').textContent) + 1;
            selectedIdx = -1;
            document.querySelectorAll('.data-item').forEach(e => e.classList.remove('is-min'));
            
            if (pos + K > data.length) {
                msg("Stream Complete!");
                return;
            }
            updateOffset();
        } else {
            msg("Incorrect! That's not the minimum.");
        }
    }
    
    function msg(t) { document.getElementById('msg').textContent = t; }

    window.onload = init;
</script>
</body>
</html>
