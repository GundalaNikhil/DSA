<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STK-008: Empire History</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #3e2723; --gold: #ffca28; --stone: #cfd8dc; --banner: #c62828; }
        * { box-sizing: border-box; }
        body { font-family: 'Cinzel', serif; background: var(--bg); color: #fff; margin: 0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
        
        header { width: 100%; text-align: center; border-bottom: 2px solid var(--gold); padding: 15px; background: #22120e; }
        h1 { margin: 0; color: var(--gold); font-size: 2rem; }

        main { flex: 1; display: flex; flex-direction: column; width: 100%; max-width: 900px; padding: 20px; align-items: center; justify-content: center; }

        .timeline {
            display: flex; gap: 4px; align-items: flex-end; height: 400px; width: 100%;
            border-bottom: 5px solid #5d4037; padding-bottom: 0px; position: relative;
        }

        .era {
            flex: 1; background: #795548; border: 1px solid #3e2723; cursor: pointer;
            position: relative; transition: all 0.2s;
        }
        .era:hover { background: #8d6e63; }
        
        .era.highlight { background: var(--gold); box-shadow: 0 0 15px var(--gold); z-index: 10; }
        .era.span-range { background: #bcaaa4; }
        
        .tooltip {
            position: absolute; top: -40px; left: 50%; transform: translateX(-50%);
            background: #fff; color: #000; padding: 5px; border-radius: 3px; font-weight: bold;
            display: none; white-space: nowrap; pointer-events: none;
        }
        .era:hover .tooltip { display: block; }
        
        .info-panel {
            margin-top: 20px; font-size: 1.2rem; min-height: 40px; color: var(--gold); text-align: center;
        }
        
    </style>
</head>
<body>
<header>
    <h1>STK-008 EMPIRE HISTORY</h1>
    <div>Click an Era to calculate its Golden Age Span (Stock Span)</div>
</header>
<main>
    <div class="timeline" id="time"></div>
    <div class="info-panel" id="info">Select an era...</div>
</main>
<script>
class Game {
    constructor() {
        this.n = 20;
        this.vals = [];
        this.ui = { time: document.getElementById('time'), info: document.getElementById('info') };
        this.regen();
    }

    regen() {
        this.vals = [];
        this.ui.time.innerHTML = '';
        
        for(let i=0; i<this.n; i++) {
            let v = Math.floor(Math.random()*100) + 10;
            this.vals.push(v);
            
            let bar = document.createElement('div');
            bar.className = 'era';
            bar.style.height = (v * 3) + 'px';
            bar.onclick = () => this.calcSpan(i);
            
            let tt = document.createElement('div');
            tt.className = 'tooltip';
            tt.innerText = `Year ${i}: Power ${v}`;
            bar.appendChild(tt);
            
            this.ui.time.appendChild(bar);
        }
    }

    async calcSpan(idx) {
        // Reset classes
        Array.from(this.ui.time.children).forEach(c => c.classList.remove('highlight', 'span-range'));
        
        let els = this.ui.time.children;
        let currentVal = this.vals[idx];
        els[idx].classList.add('highlight');
        
        let span = 1;
        // Interactive "Rewind"
        for(let i=idx-1; i>=0; i--) {
            if (this.vals[i] <= currentVal) {
                els[i].classList.add('span-range');
                // Animation delay
                await new Promise(r => setTimeout(r, 100));
                span++;
            } else {
                break; // Stop at greater
            }
        }
        
        this.ui.info.innerText = `Dominance Span: ${span} Eras (Years <= Year ${idx})`;
    }
}
const game = new Game();
</script>
</body>
</html>
