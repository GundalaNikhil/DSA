<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRE-011: Underground Scanner</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root { --dirt: #5d4037; --rock: #795548; --gold: #ffd700; --scan: #00ff00; --dark: #1a1a1a; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'VT323', monospace; background: linear-gradient(180deg, var(--dirt) 0%, #3e2723 100%); min-height: 100vh; color: #fff; }
        header { background: var(--dark); padding: 15px; text-align: center; border-bottom: 4px solid var(--scan); }
        h1 { font-family: 'Press Start 2P', cursive; color: var(--scan); font-size: 1rem; }
        main { padding: 20px; max-width: 900px; margin: 0 auto; }
        .underground { background: linear-gradient(180deg, #4e342e 0%, #3e2723 100%); border: 4px solid var(--rock); border-radius: 15px; padding: 30px; position: relative; min-height: 350px; }
        .scan-indicator { position: absolute; bottom: 10px; left: 0; right: 0; height: 4px; background: var(--scan); opacity: 0.5; animation: scanUp 2s linear infinite reverse; }
        @keyframes scanUp { 0% { bottom: 10px; } 100% { bottom: calc(100% - 20px); } }
        .tree-container { display: flex; flex-direction: column; align-items: center; gap: 25px; }
        .tree-level { display: flex; gap: 20px; }
        .ore { width: 50px; height: 50px; background: var(--rock); border: 3px solid #4e342e; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .ore.detected { background: var(--gold); border-color: var(--scan); box-shadow: 0 0 20px var(--scan); animation: pulse 0.5s ease; }
        @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        .scanner { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 2.5rem; animation: bob 1s ease-in-out infinite; }
        @keyframes bob { 0%,100% { transform: translateX(-50%) translateY(0); } 50% { transform: translateX(-50%) translateY(-5px); } }
        .controls { display: flex; gap: 15px; justify-content: center; margin-top: 20px; }
        .btn { padding: 15px 25px; border: none; border-radius: 5px; font-family: 'Press Start 2P', cursive; font-size: 0.6rem; cursor: pointer; }
        .btn-scan { background: var(--scan); color: #000; }
        .btn-reset { background: var(--rock); color: #fff; }
        .btn:hover { transform: scale(1.05); }
        .view-display { background: var(--dark); border: 3px solid var(--scan); border-radius: 10px; padding: 20px; margin-top: 20px; text-align: center; }
        .view-title { color: var(--scan); font-family: 'Press Start 2P', cursive; font-size: 0.7rem; margin-bottom: 15px; }
        .view-nodes { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
        .view-node { background: var(--gold); color: #000; padding: 10px 15px; border-radius: 5px; font-weight: bold; font-size: 1.5rem; }
        #message { text-align: center; color: var(--scan); padding: 10px; font-size: 1.2rem; }
    </style>
</head>
<body>
<header>
    <h1>ðŸ”¦ UNDERGROUND SCANNER</h1>
</header>
<main>
    <div id="message">Scan from below to detect ore deposits!</div>
    <div class="underground">
        <div class="scan-indicator"></div>
        <div class="tree-container" id="tree"></div>
        <div class="scanner">ðŸ”¦</div>
    </div>
    <div class="controls">
        <button class="btn btn-scan" onclick="game.scan()">SCAN BOTTOM</button>
        <button class="btn btn-reset" onclick="game.reset()">RESET</button>
    </div>
    <div class="view-display">
        <div class="view-title">DETECTED FROM BELOW</div>
        <div class="view-nodes" id="view"></div>
    </div>
</main>
<script>
class UndergroundScanner {
    constructor() {
        this.tree = { val: 1, left: { val: 2, left: { val: 4 }, right: { val: 5, right: { val: 8 } } }, right: { val: 3, left: { val: 6 }, right: { val: 7 } } };
        this.render();
    }
    render() {
        const container = document.getElementById('tree');
        container.innerHTML = '';
        const levels = [[{ node: this.tree, col: 0 }]];
        let queue = [{ node: this.tree, col: 0 }];
        while (queue.length) {
            const next = [];
            queue.forEach(({ node, col }) => {
                if (node.left) next.push({ node: node.left, col: col - 1 });
                if (node.right) next.push({ node: node.right, col: col + 1 });
            });
            if (next.length) levels.push(next);
            queue = next;
        }
        levels.forEach(level => {
            const row = document.createElement('div');
            row.className = 'tree-level';
            level.forEach(({ node, col }) => {
                const el = document.createElement('div');
                el.className = 'ore';
                el.id = `ore-${node.val}`;
                el.dataset.col = col;
                el.textContent = node.val;
                row.appendChild(el);
            });
            container.appendChild(row);
        });
    }
    getBottomView() {
        const colMap = {};
        const queue = [{ node: this.tree, col: 0 }];
        while (queue.length) {
            const { node, col } = queue.shift();
            colMap[col] = node.val; // Overwrites, so last (deepest) wins
            if (node.left) queue.push({ node: node.left, col: col - 1 });
            if (node.right) queue.push({ node: node.right, col: col + 1 });
        }
        return Object.entries(colMap).sort((a, b) => parseInt(a[0]) - parseInt(b[0])).map(e => e[1]);
    }
    async scan() {
        document.querySelectorAll('.ore').forEach(o => o.classList.remove('detected'));
        document.getElementById('view').innerHTML = '';
        document.getElementById('message').textContent = 'SCANNING...';
        const bottomView = this.getBottomView();
        for (const val of bottomView) {
            const el = document.getElementById(`ore-${val}`);
            el.classList.add('detected');
            const viewNode = document.createElement('span');
            viewNode.className = 'view-node';
            viewNode.textContent = val;
            document.getElementById('view').appendChild(viewNode);
            await this.delay(500);
        }
        document.getElementById('message').textContent = `DETECTED: ${bottomView.join(' ')}`;
    }
    reset() {
        document.querySelectorAll('.ore').forEach(o => o.classList.remove('detected'));
        document.getElementById('view').innerHTML = '';
        document.getElementById('message').textContent = 'READY TO SCAN';
    }
    delay(ms) { return new Promise(r => setTimeout(r, ms)); }
}
const game = new UndergroundScanner();
</script>
</body>
</html>
