<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REC-014: Polarity Switch</title>
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #2d3436;
            --cell: #dfe6e9;
            --pos: #00b894;
            --neg: #d63031;
        }

        body {
            font-family: 'Righteous', cursive;
            background: var(--bg);
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        h1 { margin-top: 2rem; color: #74b9ff; }

        .battery-pack {
            background: #222;
            padding: 20px;
            border-radius: 10px;
            margin-top: 2rem;
            display: flex;
            gap: 15px;
            box-shadow: inset 0 0 20px #000;
        }

        .cell-unit {
            width: 80px;
            height: 150px;
            background: #444;
            border-radius: 5px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            padding-bottom: 20px;
            transition: all 0.3s;
        }

        /* Toggle Switch */
        .switch {
            width: 40px;
            height: 80px;
            background: #111;
            border-radius: 20px;
            position: absolute;
            top: 20px;
            cursor: pointer;
            border: 2px solid #555;
        }

        .thumb {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #888;
            position: absolute;
            left: 0;
            transition: all 0.2s;
        }
        
        /* State Positive */
        .cell-unit.pos .switch { border-color: var(--pos); }
        .cell-unit.pos .thumb { bottom: 2px; left: 2px; background: var(--pos); }
        .cell-unit.pos .val { color: var(--pos); }

        /* State Negative */
        .cell-unit.neg .switch { border-color: var(--neg); }
        .cell-unit.neg .thumb { top: 2px; left: 2px; background: var(--neg); }
        .cell-unit.neg .val { color: var(--neg); }

        .val { font-size: 1.5rem; margin-top: auto; }

        .meters {
            display: flex;
            gap: 40px;
            margin-top: 2rem;
            text-align: center;
        }
        
        .meter-val { font-size: 3rem; }

        .msg { margin-top: 1rem; color: #aaa; }

    </style>
</head>
<body>

<h1>POLARITY SWITCH</h1>

<div class="meters">
    <div>
        <div>OUTPUT</div>
        <div class="meter-val" id="output">0</div>
    </div>
    <div>
        <div>TARGET</div>
        <div class="meter-val" style="color:#f1c40f" id="target">0</div>
    </div>
</div>

<div class="battery-pack" id="pack">
    <!-- Cells -->
</div>

<div class="msg" id="msg">Flip switches to match Target. Max Negatives: <span id="maxK">1</span></div>

<script>
    const NUMS = [1, 2, 3, 5, 2];
    let signs = [1, 1, 1, 1, 1];
    const TARGET = 3; 
    // 1+2+3+5+2 = 13.
    // Need sum 3.
    // 1-2-3-5+2 ? -7.
    // 1+2-3+5-2 ? 3. (2 negs).
    
    // Let's generate a solvable case for demo
    // Nums: 5, 3, 2. Target 0. 5-3-2. (2 negs)
    
    let currentK = 1;

    function init() {
        const pack = document.getElementById('pack');
        pack.innerHTML = '';
        document.getElementById('target').textContent = TARGET;
        const maxK = 2; 
        document.getElementById('maxK').textContent = maxK; // hardcoded demo limit

        NUMS.forEach((n, i) => {
             const unit = document.createElement('div');
             unit.className = 'cell-unit pos'; // default pos
             unit.innerHTML = `
                <div class="switch" onclick="toggle(${i})">
                    <div class="thumb"></div>
                </div>
                <div class="val">+${n}</div>
             `;
             unit.id = `unit-${i}`;
             pack.appendChild(unit);
        });
        update();
    }

    function toggle(i) {
        signs[i] *= -1;
        const unit = document.getElementById(`unit-${i}`);
        if(signs[i] === 1) {
            unit.className = 'cell-unit pos';
            unit.querySelector('.val').textContent = `+${NUMS[i]}`;
        } else {
            unit.className = 'cell-unit neg';
            unit.querySelector('.val').textContent = `-${NUMS[i]}`;
        }
        update();
    }

    function update() {
        let sum = 0;
        let negs = 0;
        NUMS.forEach((n, i) => {
            sum += n * signs[i];
            if (signs[i] === -1) negs++;
        });

        const out = document.getElementById('output');
        out.textContent = sum;
        
        const m = document.getElementById('msg');
        if (sum === TARGET) {
            if (negs <= 2) {
                out.style.color = "#00b894";
                m.textContent = "VOLTAGE STABILIZED!";
                m.style.color = "#00b894";
            } else {
                out.style.color = "#e17055";
                m.textContent = "Sum match, but too many negatives!";
                m.style.color = "#e17055";
            }
        } else {
            out.style.color = "#fff";
            m.textContent = `Negatives used: ${negs} / 2`;
            m.style.color = "#aaa";
        }
    }

    window.onload = init;
</script>
</body>
</html>
