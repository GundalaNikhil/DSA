problem_id: MTH_MINIMAL_POLYNOMIAL_MATRIX
samples:
- input: '2 998244353

    1 0

    0 1'
  output: '1

    998244352 1'
public:
- input: '5 998244353

    809148057 849993941 120026868 775235388 181412406

    393488269 443340540 704951238 364894655 152417753

    980299002 260992998 854218632 518178144 225577036

    284012987 104287930 354362380 689380446 744871951

    79531577 492033623 965503611 761371949 527826710'
  output: '5

    995478904 131831792 125406040 570333093 669063027 1'
- input: '4 998244353

    751148628 276941383 610133596 295600027

    638262346 38380513 817464065 150346387

    158939532 560256254 309699820 27853390

    237320065 945075982 398198359 605095857'
  output: '4

    198502539 948992650 170090901 292163888 1'
- input: '3 998244353

    510333211 765662572 472298602

    722927518 316624578 165830066

    798577406 864575468 746339174'
  output: '3

    456733028 921810909 423191743 1'
hidden:
- input: '6 998244353

    557679799 649096026 269766215 506924290 497013797 226148417

    354525036 995444135 801831993 773233971 915253421 996262389

    145319411 176349437 563047076 767812836 890570076 508814493

    10545422 341114921 447001886 192442217 161436089 505188483

    71992253 6015564 334836196 753191918 201513886 213961999

    745225335 100768359 577384799 492411109 355446264 101698998'
  output: '6

    174646582 11277927 34418595 925869762 307113184 382906948 1'
- input: '1 998244353

    996303024'
  output: '1

    1941329 1'
- input: '5 998244353

    881278352 978727180 932107929 457591883 627568144

    783104733 328296909 394358316 670552774 823547996

    433006098 273535066 602489740 580912575 688912060

    707990536 217527335 83189355 636341420 163661669

    110569940 784538138 232402258 300632183 191475293'
  output: '5

    929948113 223774710 671782033 190924338 354851345 1'
- input: '6 998244353

    618105609 828905792 916331506 635837671 649372434 297681497

    866831325 791632826 935590529 661303833 717793095 976278004

    508316723 224741375 180495347 2867735 841131677 248926679

    232404394 98073715 998093609 862594605 660269293 157294219

    153902993 176972398 510525583 939109730 265072 347181400

    83523612 962022571 56037713 147075710 549439339 866761327'
  output: '6

    727405812 532010447 625354809 437659685 632742664 673122626 1'
- input: '7 998244353

    830989868 413959531 758324357 509466879 381169366 334751714 900492963

    560477885 340346008 569819226 83966244 948420697 650022893 904295939

    229672688 178366024 680505229 895076485 298217578 763803756 153420527

    901810103 469486359 601817116 474214661 526233893 746357679 847144781

    269014246 735907840 129106501 599046021 966112239 467521545 700178588

    373855956 191139369 27160892 930009065 392653615 918449030 500445166

    827580907 719449001 371505606 782211796 455350212 229544484 662470997'
  output: '7

    783627363 786520253 426630257 498804383 327050273 210468689 118133733 1'
- input: '1 998244353

    629415010'
  output: '1

    368829343 1'
- input: '2 998244353

    978222564 396068382

    983340385 272473079'
  output: '2

    190467658 745793063 1'
- input: '5 998244353

    36000620 694945166 295226837 688992272 514037655

    427664933 47155931 746786447 756198237 271697432

    294391911 671378998 61447023 614374583 884039248

    32670198 926838176 770978314 995975901 505527617

    652347835 678862622 487994955 526456141 186585153'
  output: '5

    331501847 704440023 987670765 56663825 669324078 1'
- input: '1 998244353

    658118367'
  output: '1

    340125986 1'
- input: '3 998244353

    757674720 790484616 189953165

    935135950 913693214 141356185

    88932256 450512628 895569858'
  output: '3

    931660743 544565304 427795267 1'
- input: '1 998244353

    337408933'
  output: '1

    660835420 1'
- input: '9 998244353

    297939907 915446370 208501740 703413874 659281551 791834809 17904060 357196310
    899015602

    721544753 910780050 966009533 339818115 963937195 761614695 181691657 972514537
    630122695

    775387120 393264998 554416338 15216218 713496434 432903803 447083251 899491426
    716961528

    719021738 66017304 69744792 207167679 885888054 817432212 538509113 158391889
    782711695

    286298150 90160709 185311976 476095915 47790560 295843204 653403071 213334678
    739503930

    542739803 439430470 185723207 682147868 801900912 904223791 899644995 3462152
    334110361

    293950935 601896059 376544916 126395063 366631819 500634572 610071396 897761578
    747638042

    92444053 607941115 497148239 94663182 124835032 985706904 97239910 195958920 783348757

    92790248 199349714 340914414 634740899 672833401 21590125 823262095 181822972
    846899566'
  output: '9

    296444424 118608043 412193858 184489764 375153191 785222627 697503673 879546557
    415973558 1'
- input: '3 998244353

    333382948 57268351 407281502

    757969344 308246106 191130376

    299534668 150781347 606707033'
  output: '3

    921164159 7755414 748152619 1'
- input: '4 998244353

    190172648 316681193 278479334 748997374

    472015104 284053184 99226690 526010720

    381342741 621370276 390426698 374584710

    829326555 689155320 561612863 482832859'
  output: '4

    485376520 100094844 24544119 649003317 1'
- input: '7 998244353

    167186137 577618107 610649119 226197454 753968049 465846541 372504153

    693645789 870706181 732310984 854989911 309977457 222744472 367414224

    751247570 540913819 592288022 891052897 797931673 852867794 288782987

    97450121 551122099 830441589 226261010 277255013 234349438 502176380

    280081168 33767082 989903392 123800483 555156538 706878792 677653137

    200172866 510252663 150125515 501702509 630093997 346808902 399735559

    605342814 405777943 706849407 631779785 967736552 36345929 346144349'
  output: '7

    514843413 54594252 94552791 501875977 862212593 481082246 888426273 1'
- input: '2 998244353

    200909460 980486083

    384404444 328860953'
  output: '2

    986741387 468473940 1'
- input: '1 998244353

    471382013'
  output: '1

    526862340 1'
- input: '8 998244353

    637346037 618437921 745712019 467043846 784856806 428781058 508494141 895604200

    261551403 271200090 776715256 400736317 645256477 362794021 518142267 728593785

    430734870 322308625 43088147 997494912 942136201 251580981 819450756 967296990

    995236710 544344970 115808760 452030261 457300445 831153961 289224147 620073011

    430302173 636810563 30660886 176121538 549975232 178654244 990369637 322748286

    951974394 640864045 749076127 562732476 213097103 609872762 807292889 149839821

    139469212 712327223 357713985 846719967 57767414 97064811 332079935 851330633

    822296311 151892535 860592930 371624674 492539893 425195177 177534709 494552310'
  output: '8

    918641688 525216591 458546799 557255443 115336817 329664313 984772050 602832638
    1'
- input: '4 998244353

    165504351 735205605 596300619 908029521

    832803308 401856265 5309416 512544312

    171079075 370131551 107281279 505518396

    590374468 737431324 423105056 750309046'
  output: '4

    653576934 268936193 944411540 571537765 1'
- input: '4 998244353

    819325320 984567286 102891162 416154320

    137978393 341832901 819312568 143372740

    429371703 830282074 351233662 964243021

    304077884 880243961 724506875 784231079'
  output: '4

    8652057 937517072 508899877 698110097 1'
- input: '10 998244353

    28879653 238042160 950893011 653395881 191297872 824466143 252498535 396353078
    388995663 364912176

    538434202 883945228 1708903 655590808 643354090 807115040 427543329 982029247
    82967632 693183317

    247039512 148262160 536816895 201831842 47510841 226809000 324203372 467507869
    99697311 364628392

    412388297 702275407 193140002 457104051 161863973 305977902 334032573 415339993
    725068787 881837331

    516096218 37394844 280267549 452836541 192755937 175602826 427581324 732656759
    555498795 895750327

    114278937 499206945 865681730 88734530 371822692 736657349 786699135 108882895
    704233550 926066332

    434300167 862805514 866419051 13125946 172747645 342551325 138232995 617060322
    544355354 412306429

    736907565 488221894 12443230 521988185 702030905 719616320 431325735 453609821
    828241129 58531054

    325294935 456320088 277722302 796786236 680878139 124509405 648149267 866643962
    861590184 975183998

    483473665 539084522 400318129 838596152 508467523 764529386 359771701 906418925
    574477822 391767365'
  output: '10

    617301400 629204729 938180854 361320949 430649526 333465495 268917458 300904780
    644580956 309862287 1'
- input: '8 998244353

    466957486 52123292 499035658 302488060 42782651 130514870 931897007 525726985

    494190442 394175052 53766019 954734652 643523776 737003118 396529010 270933847

    457094619 362346788 724771740 317982686 823381466 879576390 25265519 582771762

    286941953 191907920 314863712 383202737 447815017 18810873 479715798 348571549

    319635063 682881227 38241399 639712731 119919013 383588343 785876277 39312208

    570445247 793151937 425432156 266960905 188155696 90244626 574435989 101546534

    135350127 780382037 155310652 679592700 529838219 462890681 958547239 294952837

    370855688 491806906 739799487 662757621 262101135 986527287 886450549 970212147'
  output: '8

    86278795 454681459 439763186 393839252 811721877 808980550 962105098 883191725
    1'
- input: '2 998244353

    410075954 550434718

    778891323 84573132'
  output: '2

    184984393 503595267 1'
- input: '5 998244353

    453688034 430290856 24034078 197493711 801834996

    275799180 774805614 701041129 797451849 948033893

    85129775 898564400 979624738 465397586 125010851

    852169608 205775789 612993971 280220571 325560046

    660975575 551945791 578916093 917237134 852254086'
  output: '5

    41783720 829375550 660630715 222800895 652384369 1'
- input: '5 998244353

    801945329 739661317 835702900 199408320 297269519

    538549262 720952828 49115293 649208541 428069335

    976832772 194626885 728220564 305922472 292787282

    5423527 437209194 222410957 20099316 839720413

    444877910 705676856 139336198 295030606 286746273'
  output: '5

    316883606 626527837 237550240 510065258 436768749 1'
- input: '6 998244353

    237358917 68421465 656471019 309056512 781860106 764540259

    654248239 887957620 494612888 631268027 451792747 681581955

    639124162 352994790 581386019 417727993 510674706 598779777

    13493954 368240534 365712145 343213850 371907995 883290841

    477152687 162971060 496012400 917357757 797329706 535769949

    226170181 571488738 749176905 182550509 722613163 418825082'
  output: '6

    502618997 200111133 599448248 117260305 87287847 726906218 1'
- input: '4 998244353

    803170583 568644813 396416310 326452658

    313342602 806227124 338591692 484793554

    724240334 501845574 31744717 167396883

    670941214 628071202 179029593 670299588'
  output: '4

    23333874 742452954 190945291 683291047 1'
- input: '9 998244353

    798919770 526946182 252027142 402958483 989105500 577235776 141408993 406334876
    651892005

    912324279 132600684 104131289 424933004 234403617 226887199 118791028 612832797
    310686099

    191794383 928672101 170851134 823425368 834860763 788621182 430695570 590633547
    438640915

    377983555 806681748 233810072 449017351 966860385 643438223 299444821 342956891
    827317727

    389955840 676753340 113428775 713216442 950001521 737492998 679810192 817926197
    683127927

    341208413 539345534 575125160 571776543 421092945 241698434 922404984 433755155
    531323119

    812638078 498123804 307394485 887059388 992728359 482599626 168542889 992041404
    937743723

    190725138 429555102 309675531 3583486 571945444 891062156 358688662 819195114
    498239279

    704579307 184974223 733743378 974185433 105573615 411622607 622939720 701265340
    448931346'
  output: '9

    480729054 691244074 275229932 186680910 299618672 680290058 450349904 10595991
    811463522 1'
- input: '10 998244353

    268371844 178733850 611287818 671620278 506713306 734829245 97674471 397602212
    24394894 797752993

    645686685 948664302 848127045 702351753 418049981 592767076 549042259 927109787
    207266073 913012344

    980548298 173279673 491525614 396279795 776379876 939148501 256962879 188131372
    506987486 765355140

    989330349 214517837 346522472 142431913 314586943 69592233 960403717 33167626
    222272362 620195688

    495187813 493054651 263117180 734086245 647733667 476368989 259720591 855507623
    189921188 495431160

    537101700 688675739 119354239 862952313 648547358 899661919 355686893 936394625
    988009782 975900998

    171011192 262920130 496296602 775291270 74992570 7390903 803812343 34706089 732317261
    726786176

    436311454 931001496 558096119 504883307 925746887 413729471 75554497 840785729
    447846556 279204274

    948497392 768773997 576965985 129903401 768578864 833864175 651736500 694806885
    573561540 767472238

    25469289 470858471 516263188 888793910 779570659 64195017 314566696 871515860
    427775236 889388663'
  output: '10

    566420182 598412317 118383387 68584422 54728637 570656226 875910797 697680897
    823873239 481772937 1'
