problem_id: HEP_ROPE_CONNECT_MAXIMIZE_PRIORITY__6742
samples:
  - input: |-
      3
      6 5 4
      1 2 3
    output: |-
      13
  - input: |-
      3
      10 20 30
      2 2 2
    output: |-
      60
public:
  - input: |-
      1
      100
      1
    output: |-
      100
  - input: |-
      2
      10 10
      1 3
    output: |-
      18
  - input: |-
      2
      5 5
      1 2
    output: |-
      9
  - input: |-
      2
      5 5
      2 3
    output: |-
      9
hidden:
  - input: |-
      10
      95 4 66 77 76 30 91 100 4 91
      1 1 1 1 1 1 1 1 1 1
    output: |-
      634
  - input: |-
      10
      15 63 93 5 89 78 6 98 76 40
      2 2 2 2 2 2 2 2 2 2
    output: |-
      563
  - input: |-
      10
      15 63 93 5 89 78 6 98 76 40
      3 3 3 3 3 3 3 3 3 3
    output: |-
      563
  - input: |-
      1000
      407639 682695 233288 751360 287592 65936 469203 336036 598203 467918 174746 357926 260519 6672 599440 813849 899254 441644 516540 449273 2155 61384 185606 601926 926857 820183 760112 292515 449547 247006 346759 704124 33028 334109 881457 774976 852001 459069 592363 695887 840163 27095 467854 761131 789108 332566 973322 736799 569499 914346 931656 310868 964630 158736 517024 402796 111440 826551 52396 835122 296054 290121 3283 101489 110786 4360 410179 80154 178932 292172 803536 521631 553399 87945 756845 990682 704515 522101 67706 598350 836660 374065 966410 849348 638824 983169 982751 469958 921489 1102 3062 182398 380602 833807 262313 547061 175895 41181 938393 577392 604390 164729 517421 735593 23216 906615 687308 77470 948521 811931 297249 444985 225237 169383 40237 672931 528307 214405 710747 998659 851330 582196 972425 654344 385493 619153 630288 405036 68773 29649 213114 922863 329926 863884 673132 893200 339212 192968 737138 316322 373387 318697 64535 703365 707085 175771 950101 31652 256592 329538 855269 969813 313219 482316 511698 894375 700359 896737 294496 755200 964515 240131 897153 370834 769874 471401 796679 841635 487444 34362 537534 886293 30631 240199 641847 475824 594267 260424 358854 855865 246466 279341 289265 381372 458713 188907 787845 178943 533424 20495 449051 364415 803527 841690 658417 443785 292931 415146 55103 170498 392170 331876 872349 687774 259362 858923 577447 915197 473392 590601 637278 529607 331065 443982 271391 326413 524415 493734 466478 164710 569031 405779 918924 557523 34097 961787 916519 228257 349836 266029 583584 652323 558619 228559 603797 232123 487249 686254 972298 990325 255742 543986 193565 7862 457995 518126 556761 391639 805662 148104 83431 806893 48599 448991 866207 704985 391182 425524 29769 448385 492860 46995 126069 419213 887469 466465 648948 462294 894304 478951 119041 847369 149048 80039 641315 542172 305694 96886 134143 818355 897414 197447 466871 41274 55471 672161 580855 993721 944163 185207 619228 745241 398983 81921 949537 644440 3881 148275 559374 16814 869493 472114 154443 808051 329247 99095 436328 361507 418829 164434 490385 386921 786102 924631 884182 945551 431207 939033 820611 252895 727401 375348 345223 501706 579832 788069 509172 89526 781939 956059 339554 144280 891854 706592 435820 688073 849511 167917 421964 374472 435786 853348 651334 383101 798521 505202 657351 376033 914501 617588 594344 319420 416310 100926 524655 39935 496874 326380 850156 462247 570809 396583 730837 591238 889346 395791 280549 694723 104814 441494 605625 774658 164708 609632 8972 269400 57995 446088 66836 224642 203400 25069 264849 272581 343865 508074 256883 835696 781585 39096 394547 927415 196512 876361 567496 514849 313232 379913 569036 369458 817898 635647 178557 726096 158165 672134 675427 53512 9298 540764 304756 716850 798884 338555 316899 167828 316819 918521 634150 912452 335855 690455 670003 97134 456667 464491 373129 719876 730760 376553 666810 935948 4402 435059 807381 278950 363338 601388 128987 174011 531032 240244 603246 870496 223630 576056 844673 787908 661499 740016 139354 416032 573097 376029 165688 302465 710923 313307 126322 121549 922471 111369 118289 237901 498031 612902 918241 718334 224143 815669 220550 798775 380870 311582 117916 22714 743273 652434 486323 237765 797761 800685 327247 248150 395442 261173 309296 738876 889759 676409 511234 569460 914710 965027 758452 320267 609678 279575 675511 210106 711186 319655 530750 912018 388317 274335 314363 280098 180095 630400 408214 894168 121981 170500 780997 976366 441363 882015 584139 788331 802353 664220 438089 330555 785154 401145 394014 828826 221632 287886 832851 642801 954971 957694 669007 126283 127054 23083 145486 230556 842954 204768 95492 667297 529071 706513 609786 975458 419012 832155 939566 627696 162210 376642 134613 725443 667274 118639 901691 710348 477464 625297 426411 150535 266984 337511 945890 972795 51592 641281 720787 360438 524829 757795 725681 761851 95650 706908 44795 740517 7875 668973 610464 295887 926912 165424 197950 622406 160702 278430 62624 558441 724420 861517 458473 760679 957791 375169 193894 915338 563417 443699 588003 898395 255033 93165 230748 862559 703104 861758 203995 522192 191319 717617 454557 798192 803872 933761 101268 581606 107474 585128 599744 470695 932275 917359 740690 183373 932359 719854 569091 653695 626430 662105 641686 708752 201854 41074 55042 485869 927633 219695 104206 959584 207965 903845 768086 514721 23529 710792 695634 827401 108524 93795 237622 984879 873477 531055 485348 127745 302125 94035 931947 476428 365592 690576 795518 601592 347897 630485 752130 39213 198232 348986 100190 751856 474101 416949 646275 59968 809711 711892 713116 929086 902155 333326 601557 83595 739642 610428 523323 231987 110811 213870 972187 870180 723181 158948 450870 568863 911264 823776 362531 975833 724995 569280 602556 14716 687785 222953 927510 243023 767952 803628 723706 170847 468665 389045 139351 587920 217372 60461 915986 136468 392979 167277 158598 379296 511089 863477 731139 267356 821320 444022 161272 501111 628819 229859 352556 671038 306589 308184 404917 850548 436581 868587 549574 681834 431463 469163 686501 300982 429060 658493 481120 336869 722764 747936 635617 655683 216959 631445 406221 717249 489530 305031 27147 353960 488340 793771 793970 747688 284976 57388 982332 245918 805201 321855 737503 822429 361048 699646 467336 593289 25842 979918 391751 158155 903283 825821 251405 281285 114958 18674 132848 898951 757828 121199 656016 9908 894384 213982 857074 461208 51826 513954 226581 785165 426824 221071 717442 846189 506001 176394 898079 823953 561427 599012 838845 327550 138111 745683 871555 736095 285063 905648 77852 678972 864973 365635 400262 192007 374484 964401 842542 764290 879278 471461 21481 11025 573563 480277 46120 128788 1688 162841 191799 750110 131445 600782 624231 486004 9977 878552 266091 491775 188931 342152 223998 260593 847582 878792 975941 286758 511678 708647 304432 505900 480985 408993 917684 405372 121928 94334 616365 93953 581783 67906 908805 404405 882372 738327 508811 444603 824894 558495 614537 443954 342427 283572 926943 602181 631904 930210 64385 320865 673477 104099 712766 350570 782287 765213 548069 24079 974576 422056 245989 320519 740871 316010 354080 808756 723508 986778 60881 553548 6210 384754 145198 472560 279901 451276 750719 145010 230872 333867 538056 930970 311633 762040 392794 293593 411131 838742 850517 624634 475088 852527 940943 649392 121860 178011 855703 113872 26828 2566 322615 337347 515408 360871 245543 823149 284109 390290 770710 868824 210447 417804 870036 589483 966745 738277 389778 303206 106181 974000 817718 488348 596607 83454 373202 927242 279418 700308 534044 911942 506367 83415 552391 524318 222610 800187 775377 536416 841626 726376 858898 697457 123257 179684 288781 596877 45337 761845 634915 308279 974827 797045 10093 519152
      2 2 1 3 3 3 3 3 1 3 2 3 1 2 3 2 3 2 2 1 3 3 1 3 2 3 1 1 2 2 2 1 1 1 3 1 3 1 2 2 3 3 2 1 3 1 3 2 2 3 3 2 2 3 2 1 1 2 2 1 1 2 2 1 2 3 3 3 2 3 1 3 3 3 3 1 2 2 2 2 3 1 3 1 3 1 2 2 3 1 3 1 2 3 3 3 1 3 3 1 3 1 2 1 1 3 1 1 3 2 1 3 3 1 3 1 3 1 3 3 2 3 2 2 2 2 1 3 3 3 3 1 3 3 3 1 1 2 3 2 2 1 1 2 1 1 3 2 1 1 3 1 3 2 2 1 1 1 1 3 1 3 3 1 1 2 2 3 3 3 2 3 1 3 3 3 2 1 1 2 3 3 3 2 2 2 2 3 3 2 2 2 1 2 1 3 1 1 3 3 2 3 2 2 1 1 1 2 3 3 2 3 2 3 2 2 1 3 1 2 3 2 3 2 2 2 3 2 1 1 3 1 1 2 2 2 1 3 3 2 2 1 2 1 3 3 2 1 1 2 2 3 2 2 2 1 1 2 1 1 1 1 1 1 3 3 3 3 2 2 3 1 1 2 2 3 2 1 2 2 1 1 1 1 1 1 2 3 2 3 1 3 1 3 1 2 3 2 3 3 2 2 2 2 2 2 2 1 3 1 3 3 1 3 3 3 1 1 3 2 2 1 2 1 2 3 2 1 1 2 3 1 3 2 3 1 1 1 1 1 3 2 3 3 3 3 3 3 2 1 2 2 3 1 3 1 3 2 3 2 3 3 2 1 3 1 1 2 1 1 1 3 3 3 1 1 1 2 3 3 3 3 1 3 2 1 3 1 1 1 2 2 3 1 2 1 3 1 2 2 2 1 2 3 3 1 2 3 1 3 1 3 2 2 2 2 3 1 2 3 1 3 3 1 3 3 3 1 2 3 2 3 2 1 3 2 2 2 2 3 3 2 3 2 3 2 1 3 2 2 3 1 1 3 1 3 1 3 3 2 2 3 3 2 3 1 3 1 2 3 1 3 1 1 2 2 2 1 3 1 2 2 1 1 1 3 1 1 1 3 1 1 3 1 3 3 1 1 1 1 1 2 2 1 3 3 1 2 3 1 2 3 2 3 2 1 2 1 2 1 2 3 1 2 3 3 3 2 1 1 3 2 2 3 2 1 1 1 2 2 2 1 3 1 3 1 2 2 2 3 2 1 3 2 1 2 2 1 2 1 1 2 2 1 3 3 3 2 1 3 1 2 1 3 2 3 3 2 1 3 3 3 3 3 1 3 1 3 1 2 1 1 2 3 2 2 3 3 3 3 2 3 3 3 3 1 1 3 3 3 1 2 3 1 2 2 3 1 1 3 1 1 1 3 2 2 3 2 1 2 1 2 3 1 2 2 2 2 1 1 1 2 1 1 1 1 3 3 1 3 3 1 1 1 1 1 3 2 3 2 1 1 3 1 1 2 2 2 3 3 2 1 2 2 2 3 2 2 2 2 2 3 1 1 2 2 3 2 2 1 2 2 2 3 2 1 3 1 3 2 3 1 3 1 1 3 3 3 1 1 3 1 2 1 2 3 3 3 1 1 3 2 3 3 2 1 2 2 3 3 3 1 3 2 2 1 3 2 3 3 2 1 1 1 1 3 3 1 3 1 2 1 2 2 3 3 1 1 1 1 1 2 2 2 1 3 1 1 2 3 3 1 1 3 2 2 3 1 2 1 3 2 3 3 3 2 3 2 2 1 1 1 3 1 3 2 1 2 2 2 2 3 1 3 1 2 2 3 2 1 3 3 2 3 1 3 3 3 2 1 2 2 2 3 1 1 2 3 2 1 2 1 1 2 3 2 2 2 1 1 2 3 3 1 1 2 2 2 1 1 3 1 1 3 2 3 3 1 1 3 2 2 2 3 1 3 1 1 2 2 3 1 2 3 2 3 1 1 3 2 3 3 2 1 1 2 2 1 1 1 3 1 3 3 2 1 3 3 1 3 1 1 2 3 1 2 2 2 2 2 2 3 1 3 3 3 3 2 2 2 1 2 1 1 3 2 1 3 3 2 1 1 2 3 1 1 2 1 2 2 3 2 1 1 1 2 3 2 1 3 1 2 2 1 1 3 2 3 2 3 2 2 2 3 1 1 1 1 3 2 2 3 2 3 2 2 3 3 1 1 2 3 3 1 3 1 1 1 1 2 2 2 3 1 3 1 3 1 1 1
    output: |-
      497240631
  - input: |-
      1
      50
      3
    output: |-
      50
  - input: |-
      10
      10 10 10 10 10 10 10 10 10 10
      1 1 1 1 1 3 3 3 3 3
    output: |-
      98
  - input: |-
      10
      10 10 10 10 10 10 10 10 10 10
      2 2 2 2 2 3 3 3 3 3
    output: |-
      99
  - input: |-
      50
      53 19 84 79 84 63 3 70 18 47 58 27 10 11 91 55 76 54 54 14 70 9 47 12 51 96 48 1 4 66 48 78 69 78 3 67 75 83 65 12 44 93 8 24 100 27 15 19 94 43
      2 1 1 1 1 1 1 1 2 3 3 2 2 1 2 3 1 1 1 2 1 3 2 2 2 1 1 3 1 3 3 2 2 2 1 3 3 1 1 1 1 2 1 3 1 1 2 2 2 1
    output: |-
      2417
  - input: |-
      200
      21 87 85 73 93 36 3 74 31 67 66 33 60 77 28 61 88 66 3 13 56 45 1 20 3 72 74 62 65 12 73 85 22 58 38 33 27 34 93 11 62 75 80 43 80 100 100 62 74 70 41 72 54 51 29 61 9 61 39 31 80 85 26 46 85 4 43 89 33 65 16 59 12 14 79 1 82 66 16 87 21 77 18 4 24 25 29 13 34 33 54 24 21 58 64 30 24 34 89 54 41 53 22 65 47 82 30 13 2 78 16 27 31 58 13 47 8 21 20 94 52 87 22 79 65 95 3 21 46 83 65 25 18 58 6 88 19 79 55 61 50 34 12 3 7 18 53 49 4 11 31 2 77 21 99 32 41 4 41 72 96 95 82 50 88 34 24 14 33 55 27 6 25 69 98 50 99 55 35 39 35 69 34 46 49 55 72 96 61 46 45 44 13 61 45 57 45 36 20 44
      3 1 3 1 2 2 2 2 2 2 3 1 2 2 1 3 2 1 2 1 2 1 2 3 1 2 2 1 1 3 3 3 1 1 2 1 1 1 1 2 1 2 1 3 1 1 1 1 2 3 3 3 2 3 1 3 2 1 1 3 1 1 2 3 1 2 2 2 2 2 2 1 1 1 1 2 2 3 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 3 1 1 1 1 1 1 1 3 3 1 2 3 1 2 3 3 2 1 2 2 2 1 1 1 1 1 1 2 2 1 3 3 2 2 3 2 3 1 2 2 2 3 2 1 2 3 3 3 1 1 3 2 3 3 2 3 1 2 1 1 2 1 3 1 2 2 2 2 3 2 3 2 2 1 2 2 1 2 1 2 1 3 1 1 2 2 3 3 3 1 1 3 3 2 3 2 1 2 1 2 1 3 1 1 1 1
    output: |-
      9362
  - input: |-
      5
      1000000000 1000000000 1000000000 1000000000 1000000000
      1 2 3 1 2
    output: |-
      4999999998
