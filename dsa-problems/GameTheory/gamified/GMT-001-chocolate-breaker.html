<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMT-001: Pile Splitter</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container { max-width: 800px; margin: 0 auto; }

        .header { text-align: center; color: #fff; margin-bottom: 20px; }
        .header h1 { font-size: 36px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }

        /* Tutorial */
        .tutorial {
            background: #fff;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .tutorial h2 { color: #667eea; margin-bottom: 15px; }

        .rules-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        .rule {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 15px;
            background: #f0f4ff;
            border-radius: 12px;
        }
        .rule-icon { font-size: 24px; }
        .rule-text { font-size: 14px; color: #555; }
        .rule-text strong { color: #667eea; }

        /* Game */
        .game-card {
            background: #fff;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .turn-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 12px;
            color: #fff;
            margin-bottom: 20px;
        }
        .turn-text { font-size: 18px; font-weight: 700; }
        .turn-bar.ai { background: linear-gradient(90deg, #e74c3c, #c0392b); }

        /* Piles */
        .piles-area {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            margin-bottom: 20px;
            min-height: 100px;
        }

        .pile {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 15px;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }
        .pile:hover { transform: scale(1.05); }
        .pile.selected { box-shadow: 0 0 0 4px #ffd700; }
        .pile.disabled { opacity: 0.4; cursor: not-allowed; }
        .pile .count { font-size: 32px; font-weight: 800; }
        .pile .label { font-size: 11px; opacity: 0.8; }

        /* Split Controls */
        .split-controls {
            padding: 20px;
            background: #f0f4ff;
            border-radius: 15px;
            margin-bottom: 20px;
            display: none;
        }
        .split-controls.active { display: block; }

        .split-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        .split-num {
            width: 60px;
            height: 60px;
            background: #667eea;
            color: #fff;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
        }
        .split-plus { font-size: 24px; color: #667eea; }

        .slider-row { display: flex; align-items: center; gap: 15px; }
        .slider-row input { flex: 1; height: 8px; }
        .slider-row span { min-width: 80px; text-align: center; color: #666; }

        .btn-row { display: flex; gap: 10px; justify-content: center; margin-top: 15px; }
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }
        .btn-split { background: #27ae60; color: #fff; }
        .btn-cancel { background: #95a5a6; color: #fff; }
        .btn:hover { filter: brightness(1.1); }

        /* Result */
        .result {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            font-size: 20px;
            font-weight: 700;
            display: none;
        }
        .result.win { display: block; background: #d5f5e3; color: #27ae60; }
        .result.lose { display: block; background: #fadbd8; color: #e74c3c; }

        .message {
            text-align: center;
            padding: 15px;
            color: #666;
            min-height: 50px;
        }

        .new-game {
            display: block;
            width: 100%;
            margin-top: 15px;
            padding: 15px;
            background: #667eea;
            border: none;
            color: #fff;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            border-radius: 10px;
            cursor: pointer;
        }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>üéÆ Pile Splitter</h1>
        <div style="opacity:0.9">Nim-variant: Split piles into unequal parts!</div>
    </div>

    <div class="tutorial">
        <h2>üìñ How to Play</h2>
        <div class="rules-grid">
            <div class="rule">
                <span class="rule-icon">üéØ</span>
                <span class="rule-text"><strong>Goal:</strong> Be the last player to make a valid split</span>
            </div>
            <div class="rule">
                <span class="rule-icon">‚úÇÔ∏è</span>
                <span class="rule-text"><strong>Your Move:</strong> Pick a pile and split it into TWO unequal parts</span>
            </div>
            <div class="rule">
                <span class="rule-icon">‚ö†Ô∏è</span>
                <span class="rule-text"><strong>Rule:</strong> Cannot split into equal halves (5‚Üí2+3 OK, 4‚Üí2+2 NOT OK)</span>
            </div>
            <div class="rule">
                <span class="rule-icon">üèÜ</span>
                <span class="rule-text"><strong>Win:</strong> If your opponent can't move, you win!</span>
            </div>
        </div>
    </div>

    <div class="game-card">
        <div class="turn-bar" id="turnBar">
            <span class="turn-text" id="turnText">üü¢ Your Turn</span>
            <span id="moveCount">Move: 0</span>
        </div>

        <div class="message" id="message">Click a pile to select it, then choose how to split!</div>

        <div class="piles-area" id="pilesArea"></div>

        <div class="split-controls" id="splitControls">
            <div class="split-display">
                <div class="split-num" id="leftNum">1</div>
                <div class="split-plus">+</div>
                <div class="split-num" id="rightNum">?</div>
            </div>
            <div class="slider-row">
                <span>1</span>
                <input type="range" id="splitSlider" min="1" max="1" value="1">
                <span id="maxVal">1</span>
            </div>
            <div class="btn-row">
                <button class="btn btn-split" onclick="confirmSplit()">‚úì Split</button>
                <button class="btn btn-cancel" onclick="cancelSplit()">‚úï Cancel</button>
            </div>
        </div>

        <div class="result" id="result"></div>

        <button class="new-game" onclick="newGame()">üîÑ New Game</button>
    </div>
</div>

<script>
    let piles = [];
    let selectedPile = -1;
    let isPlayerTurn = true;
    let moveCount = 0;
    let gameOver = false;

    function init() {
        piles = [8];
        selectedPile = -1;
        isPlayerTurn = true;
        moveCount = 0;
        gameOver = false;
        document.getElementById('result').className = 'result';
        updateUI();
    }

    function updateUI() {
        // Update turn bar
        const turnBar = document.getElementById('turnBar');
        const turnText = document.getElementById('turnText');
        if (isPlayerTurn) {
            turnBar.className = 'turn-bar';
            turnText.textContent = 'üü¢ Your Turn';
        } else {
            turnBar.className = 'turn-bar ai';
            turnText.textContent = 'üî¥ AI Turn';
        }
        document.getElementById('moveCount').textContent = 'Move: ' + moveCount;

        // Update piles
        const area = document.getElementById('pilesArea');
        area.innerHTML = '';
        piles.forEach((size, i) => {
            const canSplit = size >= 3;
            const pile = document.createElement('div');
            pile.className = 'pile' + (i === selectedPile ? ' selected' : '') + (!canSplit ? ' disabled' : '');
            pile.innerHTML = `<div class="count">${size}</div><div class="label">${canSplit ? 'Click to split' : 'Too small'}</div>`;
            if (canSplit && isPlayerTurn && !gameOver) {
                pile.onclick = () => selectPile(i);
            }
            area.appendChild(pile);
        });
    }

    function selectPile(i) {
        if (!isPlayerTurn || gameOver) return;
        selectedPile = i;
        updateUI();

        const size = piles[i];
        const maxLeft = Math.floor((size - 1) / 2);
        const slider = document.getElementById('splitSlider');
        slider.min = 1;
        slider.max = maxLeft;
        slider.value = 1;
        document.getElementById('maxVal').textContent = maxLeft;
        updateSplitDisplay();

        document.getElementById('splitControls').classList.add('active');
        document.getElementById('message').textContent = 'Use slider to choose how to split, then confirm!';
    }

    function updateSplitDisplay() {
        const size = piles[selectedPile];
        const left = parseInt(document.getElementById('splitSlider').value);
        const right = size - left;
        document.getElementById('leftNum').textContent = left;
        document.getElementById('rightNum').textContent = right;
    }

    function cancelSplit() {
        selectedPile = -1;
        document.getElementById('splitControls').classList.remove('active');
        document.getElementById('message').textContent = 'Click a pile to select it!';
        updateUI();
    }

    function confirmSplit() {
        if (selectedPile < 0 || gameOver) return;

        const size = piles[selectedPile];
        const left = parseInt(document.getElementById('splitSlider').value);
        const right = size - left;

        if (left === right) {
            document.getElementById('message').textContent = '‚ùå Cannot split into equal parts!';
            return;
        }

        // Make the split
        piles.splice(selectedPile, 1, left, right);
        selectedPile = -1;
        moveCount++;
        document.getElementById('splitControls').classList.remove('active');

        // Check if AI can move
        if (!hasValidMove()) {
            endGame(true);
            return;
        }

        // AI turn
        isPlayerTurn = false;
        updateUI();
        document.getElementById('message').textContent = 'ü§ñ AI is thinking...';

        setTimeout(aiMove, 1000);
    }

    function aiMove() {
        if (gameOver) return;

        // Find any valid split
        for (let i = 0; i < piles.length; i++) {
            const size = piles[i];
            if (size >= 3) {
                // Simple AI: split into 1 and (size-1) if possible
                const left = 1;
                const right = size - 1;
                piles.splice(i, 1, left, right);
                moveCount++;
                document.getElementById('message').textContent = `ü§ñ AI splits ${size} into ${left} + ${right}`;
                break;
            }
        }

        // Check if player can move
        if (!hasValidMove()) {
            endGame(false);
            return;
        }

        isPlayerTurn = true;
        updateUI();
        setTimeout(() => {
            document.getElementById('message').textContent = 'Your turn! Click a pile to split.';
        }, 500);
    }

    function hasValidMove() {
        return piles.some(size => size >= 3);
    }

    function endGame(playerWins) {
        gameOver = true;
        const result = document.getElementById('result');
        if (playerWins) {
            result.className = 'result win';
            result.textContent = 'üéâ YOU WIN! AI cannot make any more moves!';
        } else {
            result.className = 'result lose';
            result.textContent = 'üò¢ AI WINS! You cannot make any more moves.';
        }
        document.getElementById('message').textContent = '';
    }

    function newGame() {
        init();
        document.getElementById('message').textContent = 'Click a pile to select it, then choose how to split!';
    }

    document.getElementById('splitSlider').oninput = updateSplitDisplay;
    window.onload = init;
</script>
</body>
</html>
