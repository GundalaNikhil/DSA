<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMT-011: Token Blocker</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #134e5e 0%, #71b280 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container { max-width: 800px; margin: 0 auto; }

        .header { text-align: center; color: #fff; margin-bottom: 20px; }
        .header h1 { font-size: 36px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }

        .tutorial {
            background: #fff;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .tutorial h2 { color: #134e5e; margin-bottom: 15px; }

        .rules { display: flex; gap: 15px; }
        .rule {
            flex: 1;
            background: #e8f5e9;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        .rule-icon { font-size: 28px; }
        .rule-text { font-size: 13px; color: #555; margin-top: 5px; }

        .game-card {
            background: #fff;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .turn-bar {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: linear-gradient(90deg, #134e5e, #71b280);
            border-radius: 12px;
            color: #fff;
            margin-bottom: 20px;
        }
        .turn-bar.ai { background: linear-gradient(90deg, #c0392b, #e74c3c); }

        /* Grid */
        .grid-area {
            display: flex;
            justify-content: center;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            gap: 8px;
        }

        .cell {
            width: 60px;
            height: 60px;
            background: #e0e0e0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 28px;
        }
        .cell:hover { transform: scale(1.05); }
        .cell.blocked { background: #333; cursor: not-allowed; }
        .cell.player-token { background: linear-gradient(135deg, #3498db, #2980b9); color: #fff; }
        .cell.ai-token { background: linear-gradient(135deg, #e74c3c, #c0392b); color: #fff; }
        .cell.valid { box-shadow: 0 0 0 3px #71b280; }

        .message { text-align: center; padding: 15px; color: #666; }

        .result {
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            display: none;
        }
        .result.win { display: block; background: #d1fae5; color: #059669; }
        .result.lose { display: block; background: #fee2e2; color: #dc2626; }

        .new-game {
            display: block;
            width: 100%;
            margin-top: 15px;
            padding: 15px;
            background: #134e5e;
            border: none;
            color: #fff;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            border-radius: 10px;
            cursor: pointer;
        }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>üöß Token Blocker</h1>
        <div style="opacity:0.9">Move your token or place a block!</div>
    </div>

    <div class="tutorial">
        <h2>üìñ How to Play</h2>
        <div class="rules">
            <div class="rule">
                <div class="rule-icon">üéØ</div>
                <div class="rule-text"><strong>Move your token</strong> to an adjacent empty cell</div>
            </div>
            <div class="rule">
                <div class="rule-icon">üß±</div>
                <div class="rule-text"><strong>After moving</strong>, place a block on any empty cell</div>
            </div>
            <div class="rule">
                <div class="rule-icon">üèÜ</div>
                <div class="rule-text"><strong>Trap opponent</strong> so they can't move!</div>
            </div>
        </div>
    </div>

    <div class="game-card">
        <div class="turn-bar" id="turnBar">
            <span id="turnText">üü¢ Your Turn - Move</span>
            <span id="phase">Phase: Move</span>
        </div>

        <div class="message" id="message">Click an adjacent cell to move your token (blue)!</div>

        <div class="grid-area">
            <div class="grid" id="grid"></div>
        </div>

        <div class="result" id="result"></div>

        <button class="new-game" onclick="newGame()">üîÑ New Game</button>
    </div>
</div>

<script>
    const SIZE = 5;
    let grid = []; // 0=empty, 1=blocked, 2=player, 3=ai
    let playerPos = { r: 0, c: 0 };
    let aiPos = { r: 4, c: 4 };
    let isPlayerTurn = true;
    let phase = 'move'; // 'move' or 'block'
    let gameOver = false;

    function init() {
        grid = Array(SIZE).fill().map(() => Array(SIZE).fill(0));
        playerPos = { r: 0, c: 0 };
        aiPos = { r: SIZE-1, c: SIZE-1 };
        grid[playerPos.r][playerPos.c] = 2;
        grid[aiPos.r][aiPos.c] = 3;
        isPlayerTurn = true;
        phase = 'move';
        gameOver = false;
        document.getElementById('result').className = 'result';
        render();
    }

    function render() {
        const turnBar = document.getElementById('turnBar');
        turnBar.className = isPlayerTurn ? 'turn-bar' : 'turn-bar ai';
        document.getElementById('turnText').textContent = isPlayerTurn ? 'üü¢ Your Turn' : 'üî¥ AI Turn';
        document.getElementById('phase').textContent = 'Phase: ' + (phase === 'move' ? 'Move' : 'Block');

        const container = document.getElementById('grid');
        container.style.gridTemplateColumns = `repeat(${SIZE}, 60px)`;
        container.innerHTML = '';

        const validMoves = phase === 'move' ? getValidMoves(playerPos) : [];

        for (let r = 0; r < SIZE; r++) {
            for (let c = 0; c < SIZE; c++) {
                const cell = document.createElement('div');
                cell.className = 'cell';

                if (grid[r][c] === 1) cell.classList.add('blocked');
                if (grid[r][c] === 2) { cell.classList.add('player-token'); cell.textContent = 'üîµ'; }
                if (grid[r][c] === 3) { cell.classList.add('ai-token'); cell.textContent = 'üî¥'; }
                if (validMoves.some(m => m.r === r && m.c === c)) cell.classList.add('valid');

                if (isPlayerTurn && !gameOver) {
                    if (phase === 'move' && validMoves.some(m => m.r === r && m.c === c)) {
                        cell.onclick = () => movePlayer(r, c);
                    } else if (phase === 'block' && grid[r][c] === 0) {
                        cell.onclick = () => placeBlock(r, c);
                    }
                }

                container.appendChild(cell);
            }
        }
    }

    function getValidMoves(pos) {
        const moves = [];
        const dirs = [[-1,0],[1,0],[0,-1],[0,1]];
        for (const [dr, dc] of dirs) {
            const nr = pos.r + dr;
            const nc = pos.c + dc;
            if (nr >= 0 && nr < SIZE && nc >= 0 && nc < SIZE && grid[nr][nc] === 0) {
                moves.push({ r: nr, c: nc });
            }
        }
        return moves;
    }

    function movePlayer(r, c) {
        grid[playerPos.r][playerPos.c] = 0;
        playerPos = { r, c };
        grid[r][c] = 2;
        phase = 'block';
        render();
        document.getElementById('message').textContent = 'Now click any empty cell to place a block!';
    }

    function placeBlock(r, c) {
        grid[r][c] = 1;
        phase = 'move';

        // Check if AI can move
        if (getValidMoves(aiPos).length === 0) {
            endGame(true);
            return;
        }

        isPlayerTurn = false;
        render();
        document.getElementById('message').textContent = 'ü§ñ AI is thinking...';

        setTimeout(aiMove, 800);
    }

    function aiMove() {
        if (gameOver) return;

        const moves = getValidMoves(aiPos);
        if (moves.length === 0) {
            endGame(true);
            return;
        }

        // Move AI
        const move = moves[0];
        grid[aiPos.r][aiPos.c] = 0;
        aiPos = move;
        grid[move.r][move.c] = 3;

        // AI places block (find any empty cell)
        for (let r = 0; r < SIZE; r++) {
            for (let c = 0; c < SIZE; c++) {
                if (grid[r][c] === 0) {
                    grid[r][c] = 1;
                    break;
                }
            }
            if (grid.flat().filter(x => x === 1).length > 0) break;
        }

        document.getElementById('message').textContent = `ü§ñ AI moves and places block`;

        // Check if player can move
        if (getValidMoves(playerPos).length === 0) {
            endGame(false);
            return;
        }

        isPlayerTurn = true;
        phase = 'move';
        render();
        setTimeout(() => {
            document.getElementById('message').textContent = 'Your turn! Move your token.';
        }, 500);
    }

    function endGame(playerWins) {
        gameOver = true;
        render();
        const result = document.getElementById('result');
        if (playerWins) {
            result.className = 'result win';
            result.textContent = 'üéâ YOU WIN! AI is trapped!';
        } else {
            result.className = 'result lose';
            result.textContent = 'üò¢ AI WINS! You are trapped!';
        }
        document.getElementById('message').textContent = '';
    }

    function newGame() {
        init();
        document.getElementById('message').textContent = 'Click an adjacent cell to move your token (blue)!';
    }

    window.onload = init;
</script>
</body>
</html>
